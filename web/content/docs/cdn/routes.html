<!DOCTYPE html>
<html>
	<head>
  <meta charset="utf-8">  
  <meta name="author" content="dadi.co">  
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Welcome</title>
  <link rel="stylesheet" type="text/css" href="/css/main.css">
</head>

	<body>

	  <header class="c-header c-header--acollapsed">
  <div class="c-header__inner-wrapper u-cols">
    <div class="u-col u-col--1-1 u-col--2-3@medium">
      <a href="/">
        <img class="c-header__logo" src="/public/assets/img/dadi.png" alt="DADI">
      </a>

      <h2 class="c-header__title">Developer support</h2>
      <p class="c-header__subtitle">Tutorials and documentation</p>    
    </div>

    <div class="c-header__top u-col u-col--1-1 u-col--1-3@medium">
      <ul class="c-header__links">
        <li class="c-header__link">
          <a href="http://twitter.com/dadi">@DADI</a>
        </li>
        <li class="c-header__link">
          <a href="mailto:dev@dadi.tech">dev@dadi.tech</a>
        </li>
      </ul>

      
    </div>    

    
      <div class="u-col u-col--1-1">
        <div class="c-combo">
  <label class="c-combo__item c-combo__item--expand c-text-field-container">
    <span class="c-text-field__icon fa fa-search"></span>
    <input class="c-text-field" type="text" placeholder="Search our help centre…" />
  </label>
  <button class="c-combo__item c-button c-button--blue" type="submit">Search</button>
</div>
      </div>
    
  </div>
</header>

	  <h1 id="delivery-routes">Delivery Routes</h1>

<ul>
  <li><a href="#overview">Overview</a></li>
  <li><a href="#creating-a-route">Creating a Route</a></li>
  <li><a href="#route-basics">Route Basics</a></li>
  <li><a href="#branches">Branches</a></li>
  <li><a href="#conditions">Conditions</a></li>
  <li><a href="#caching">Caching</a></li>
  <li><a href="#example">Example</a></li>
</ul>

<h2 id="overview">Overview</h2>

<p>Routes allow CDN to make a decision about which <a href="recipes.md">Delivery Recipe</a> to use for the current request, based on a set of configurable conditions.</p>

<p>Conditions can include the type of device being used, the network type, user location and language.</p>

<h2 id="creating-a-route">Creating a Route</h2>

<p>A route is defined in JSON format and added to a directory in your CDN installation. The default location for route files is <code class="highlighter-rouge">workspace/routes</code>, but this is <a href="configuration.md#routes">configurable</a>.</p>

<p>You can create route files in a text editor and manually copy them to the routes folder, or you can send a <code class="highlighter-rouge">POST</code> request to CDN with the route content and have CDN create it for you.</p>

<h3 id="posting-to-cdn">POSTing to CDN</h3>

<p>Send a <code class="highlighter-rouge">POST</code> request to the routes endpoint with the request body containing the route content.</p>

<p><strong>An example using cURL</strong></p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>curl -i -H <span class="s2">"Content-Type: application/json"</span> -X POST <span class="s2">"http://cdn.example.com/api/routes"</span> -d <span class="s1">'{
  "route": "example-route",
  "branches": [
    {
      "recipe": "thumbnail"
    }
  ]
}'</span>
</code></pre>
</div>
<p><strong>Response Codes</strong></p>

<table>
  <thead>
    <tr>
      <th>Status Code</th>
      <th>Description</th>
      <th>Response</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>200</td>
      <td>Route saved successfully</td>
      <td><code class="highlighter-rouge"><span class="p">{</span><span class="w"> </span><span class="err">success:</span><span class="w"> </span><span class="err">true</span><span class="w"> </span><span class="p">}</span></code></td>
    </tr>
    <tr>
      <td>400</td>
      <td>No request body sent</td>
      <td><code class="highlighter-rouge"><span class="p">{</span><span class="w"> </span><span class="err">success:</span><span class="w"> </span><span class="err">false,</span><span class="w">  </span><span class="err">errors:</span><span class="w"> </span><span class="err">['Bad</span><span class="w"> </span><span class="err">Request']</span><span class="w"> </span><span class="p">}</span><span class="w"> </span></code></td>
    </tr>
    <tr>
      <td>400</td>
      <td>Route validation failed</td>
      <td><code class="highlighter-rouge"><span class="p">{</span><span class="w"> </span><span class="err">success:</span><span class="w"> </span><span class="err">false,</span><span class="w"> </span><span class="err">errors:</span><span class="w"> </span><span class="err">validationErrors</span><span class="w"> </span><span class="p">}</span></code></td>
    </tr>
    <tr>
      <td>400</td>
      <td>A route with the same name already exists</td>
      <td><code class="highlighter-rouge"><span class="p">{</span><span class="w"> </span><span class="err">success:</span><span class="w"> </span><span class="err">false,</span><span class="w"> </span><span class="err">errors:</span><span class="w"> </span><span class="err">['Route</span><span class="w"> </span><span class="err">already</span><span class="w"> </span><span class="err">exists']</span><span class="w"> </span><span class="p">}</span></code></td>
    </tr>
    <tr>
      <td>400</td>
      <td>An error occurred when saving</td>
      <td><code class="highlighter-rouge"><span class="p">{</span><span class="w"> </span><span class="err">success:</span><span class="w"> </span><span class="err">false,</span><span class="w"> </span><span class="err">errors:</span><span class="w"> </span><span class="err">['Error</span><span class="w"> </span><span class="err">when</span><span class="w"> </span><span class="err">saving</span><span class="w"> </span><span class="err">route']</span><span class="w"> </span><span class="p">}</span></code></td>
    </tr>
  </tbody>
</table>

<h2 id="route-basics">Route Basics</h2>

<p>A route must contain a <code class="highlighter-rouge">name</code> property, as well as an array of <code class="highlighter-rouge">branches</code> which contain the conditions that must be true for CDN to select the route.</p>

<p>At a minimum, a route must take the following form. The <code class="highlighter-rouge">branches</code> array below contains a single branch with no conditions, representing the default recipe to use.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"route"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example-route"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"branches"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"recipe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h2 id="branches">Branches</h2>

<p>Each branch within the <code class="highlighter-rouge">branches</code> array should contain two properties, <code class="highlighter-rouge">recipe</code> and <code class="highlighter-rouge">condition</code>.</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">recipe</code> (string) - the name of the <a href="recipes.md">Delivery Recipe</a> to use when all specified conditions are met</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">condition</code> (object) - contains properties that correspond to test types</p>
  </li>
</ul>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"route"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example-route"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"branches"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"recipe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail-120"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"device"</span><span class="p">:</span><span class="w"> </span><span class="s2">"desktop"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"recipe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail-50"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h3 id="branch-evaluation">Branch Evaluation</h3>

<p>Branches are evaluated in the order they appear in the route. If a branch condition is not met, the branch is skipped and the next one evaluated.</p>

<p>The default case (where none of the conditions are met) is handled by a branch with a <code class="highlighter-rouge">recipe</code> but no <code class="highlighter-rouge">condition</code>, which is matched immediately. This branch must be last in the array, otherwise it may be used when you don’t intend it to be.</p>

<h2 id="conditions">Conditions</h2>

<h3 id="device">Device</h3>

<p>The <code class="highlighter-rouge">device</code> condition matches the user’s device type, based on the user-agent header sent in the request.</p>

<p>Possible values:</p>

<ul>
  <li><code class="highlighter-rouge">console</code></li>
  <li><code class="highlighter-rouge">desktop</code></li>
  <li><code class="highlighter-rouge">embedded</code></li>
  <li><code class="highlighter-rouge">mobile</code></li>
  <li><code class="highlighter-rouge">smarttv</code></li>
  <li><code class="highlighter-rouge">tablet</code></li>
  <li><code class="highlighter-rouge">wearable</code></li>
</ul>

<p>The <code class="highlighter-rouge">device</code> condition can test against a single device type:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"device"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mobile"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>…or multiple device types:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"device"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"tablet"</span><span class="p">,</span><span class="w"> </span><span class="s2">"smarttv"</span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h4 id="default-value">Default value</h4>

<p>If a device type is specified that doesn’t match one of the possible values above, CDN uses <code class="highlighter-rouge">desktop</code> in its place.</p>

<h3 id="location">Location</h3>

<p>The <code class="highlighter-rouge">location</code> condition uses the IP address from the request and performs a GeoLocation lookup to obtain the user’s approximate location.</p>

<p>CDN can perform the GeoLocation lookup using the <a href="http://dev.maxmind.com/geoip/">Maxmind GeoIP</a> database (bundled with the application), or by making a request to any remote address (such as the DADI GeoLocation API).</p>

<h4 id="configuring-cdn-to-use-the-maxmind-geoip-database">Configuring CDN to use the Maxmind GeoIP database</h4>

<p>To use the Maxmind GeoIP database CDN’s main configuration file should contain the following block:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"geolocation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"maxmind"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"countryDbPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vendor/maxmind-country.mmdb"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>If no value is provided for <code class="highlighter-rouge">countryDbPath</code> it defaults to the one shown in the above example.</p>

<h4 id="configuring-cdn-for-remote-lookup">Configuring CDN for remote lookup</h4>

<p>To use a remote lookup service, the <code class="highlighter-rouge">geolocation</code> block in CDN’s main configuration file should specify a remote URI.</p>

<p>The URI format uses placeholders (shown below with curly braces) to indicate where CDN should insert the parameters required for the lookup.</p>

<p><strong>Placeholders</strong></p>

<ul>
  <li><code class="highlighter-rouge"><span class="p">{</span><span class="err">ip</span><span class="p">}</span></code> - the IP address to lookup</li>
  <li><code class="highlighter-rouge"><span class="p">{</span><span class="err">key</span><span class="p">}</span></code> - <em>(optional)</em> an API key required to access the remote service</li>
  <li><code class="highlighter-rouge"><span class="p">{</span><span class="err">secret</span><span class="p">}</span></code> - <em>(optional)</em> a secret key required to access the remote service</li>
</ul>

<p><code class="highlighter-rouge"><span class="p">{</span><span class="err">key</span><span class="p">}</span></code> and <code class="highlighter-rouge"><span class="p">{</span><span class="err">secret</span><span class="p">}</span></code> can be set either in the configuration file or as environment variables. Set the environment variables <code class="highlighter-rouge">GEOLOCATION_REMOTE_KEY</code> and <code class="highlighter-rouge">GEOLOCATION_REMOTE_SECRET</code> to enable CDN to read these values from the environment.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"geolocation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"remote"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.example.com/location/?key={key}&amp;secret={secret}&amp;ip={ip}"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234567"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1q2w3e4r"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p><strong>Response format</strong></p>

<p>By default CDN expects a response from the remote service in the format used by the DADI GeoLocation service, where the path for the country code within the response is <code class="highlighter-rouge">location.country.isoCode</code>.</p>

<p>If the response format for the service you use differs (and it probably does), you can tell CDN where to find the country code in the response by adding a <code class="highlighter-rouge">path</code> property to the <code class="highlighter-rouge">geolocation</code> configuration block.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"geolocation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"remote"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.other-service.com/location/?key={key}&amp;secret={secret}&amp;ip={ip}"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234567"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1q2w3e4r"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"results.address.country"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h3 id="language">Language</h3>

<p>The <code class="highlighter-rouge">language</code> condition is based on the <code class="highlighter-rouge">Accept-Language</code> headers sent in the request. Values are ISO 639-1 language codes.</p>

<p>The following condition will be met if the request contains the header <code class="highlighter-rouge">Accept-Language: en</code></p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>Language detection has support for <a href="https://tools.ietf.org/html/rfc2616#section-14.4">quality values</a>, which represent an estimate of the user’s preference for multiple languages. By default only the main language (<code class="highlighter-rouge">quality = 1</code>) is used, but this can be changed by adding an optional <code class="highlighter-rouge">languageMinQuality</code> property to the condition, which adjusts the threshold.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"language"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"en"</span><span class="p">,</span><span class="w"> </span><span class="s2">"pt"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"languageMinQuality"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h3 id="network">Network</h3>

<p>Specifying the <code class="highlighter-rouge">network</code> condition in a route performs a remote lookup on a network connectivity API to determine the type of connection being used.</p>

<blockquote>
  <p><strong>Note:</strong> This condition tests for a <em>connection type</em> (e.g. <code class="highlighter-rouge">cable</code> or <code class="highlighter-rouge">mobile</code>) and not <em>connection speed</em>.</p>
</blockquote>

<p>The condition can be specified as a single connection type:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"network"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cable"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>…or as an array of multiple connection types:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"network"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"cable"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dsl"</span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h4 id="configuration">Configuration</h4>

<p>The configuration block required for network connectivity lookups is similar to that used for GeoLocation.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"network"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.example.com/connectivity/?key={key}&amp;secret={secret}&amp;ip={ip}"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234567"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1q2w3e4r"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>The URI format uses placeholders (shown below with curly braces) to indicate where CDN should insert the parameters required for the lookup.</p>

<p><strong>Placeholders</strong></p>

<ul>
  <li><code class="highlighter-rouge"><span class="p">{</span><span class="err">ip</span><span class="p">}</span></code> - the IP address to lookup</li>
  <li><code class="highlighter-rouge"><span class="p">{</span><span class="err">key</span><span class="p">}</span></code> - <em>(optional)</em> an API key required to access the remote service</li>
  <li><code class="highlighter-rouge"><span class="p">{</span><span class="err">secret</span><span class="p">}</span></code> - <em>(optional)</em> a secret key required to access the remote service</li>
</ul>

<p><code class="highlighter-rouge"><span class="p">{</span><span class="err">key</span><span class="p">}</span></code> and <code class="highlighter-rouge"><span class="p">{</span><span class="err">secret</span><span class="p">}</span></code> can be set either in the configuration file or as environment variables. Set the environment variables <code class="highlighter-rouge">NETWORK_REMOTE_KEY</code> and <code class="highlighter-rouge">NETWORK_REMOTE_SECRET</code> to enable CDN to read these values from the environment.</p>

<p><strong>Response format</strong></p>

<p>By default CDN expects a response from the remote service in the format used by the DADI Network Connectivity service, where the path for the connection type within the response is <code class="highlighter-rouge">speed.connectionType</code>.</p>

<p>If the response format for the service you use differs (and it probably does), you can tell CDN where to find the connection type in the response by adding a <code class="highlighter-rouge">path</code> property to the <code class="highlighter-rouge">network</code> configuration block.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"network"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://api.other-service.com/connectivity/?key={key}&amp;secret={secret}&amp;ip={ip}"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234567"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1q2w3e4r"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"results.connection.type"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h2 id="caching">Caching</h2>

<p>Caching is automatically enabled for routes. Depending on what’s defined in the config, it uses Redis or the local filesystem.</p>

<h2 id="example-route">Example route</h2>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"route"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sample-route"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"branches"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"recipe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"device"</span><span class="p">:</span><span class="w"> </span><span class="s2">"desktop"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"GB"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"US"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nt">"network"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cable"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"recipe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail-lo-res"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"device"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"mobile"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"tablet"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nt">"language"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"pt"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GB"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"network"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"cable"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"dsl"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"recipe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"default-recipe"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>


	  <footer class="c-footer">
  <div class="u-cols u-wrapper">
    <div class="u-col u-col--1-2 u-col--1-4@medium u-padding">
      <h3 class="c-footer__title">Client engagement</h3>
      <p class="epsilon"><a href="mailto:makesomething@dadi.tech">makesomething@dadi.tech</a><br>
      +44 (0) 20 7205 2902</p>
    </div>
    <div class="u-col u-col--1-2 u-col--1-4@medium u-padding">
      <h3 class="c-footer__title">Media enquiries</h3>
      <p class="epsilon"><a href="mailto:press@dadi.tech">press@dadi.tech</a><br>
      +44 (0) 20 7205 2901</p>
    </div>
    <div class="u-col u-col--1-2 u-col--1-4@medium u-padding">
      <h3 class="c-footer__title">Careers</h3>
      <p class="epsilon"><a href="mailto:joinus@dadi.tech">joinus@dadi.tech</a><br>
      +44 (0) 20 7205 2903</p>
    </div>
    <div class="u-col u-col--1-2 u-col--1-4@medium u-padding">
      <h3 class="c-footer__title">Everything else</h3>
      <p class="epsilon"><a href="mailto:hi@dadi.tech">hi@dadi.tech</a><br>
      +44 (0) 20 7205 2900<br>
      <a href="http://twitter.com/dadi">@dadi</a></p>
    </div>
  </div>

  <div class="u-wrapper u-padding">
    <img src="/public/assets/img/dadi-full.png" height="24">
  </div>
</footer>

	</body>
</html>