<h2 id="overview">Overview</h2>

<p>This document provides a simple step by step guide to installation on Ubuntu <a href="http://releases.ubuntu.com/14.04.1/">14.04.1 LTS</a>.</p>

<p>This guide assumes a single server holding both the database and the API.</p>

<p>For information on using DADI API as your data store, see the <a href="https://github.com/dadi/track/blob/docs/docs/dataStores.md">data stores documentation</a>.</p>

<h2 id="installing-dadi-track">Installing DADI Track</h2>

<h3 id="nodejs-latest">Node.js latest</h3>

<ol>
  <li><code class="highlighter-rouge">sudo apt-get -y update</code></li>
  <li><code class="highlighter-rouge">sudo apt-get -y upgrade</code></li>
  <li><code class="highlighter-rouge">sudo apt-get -y install python-software-properties</code></li>
  <li><code class="highlighter-rouge">sudo add-apt-repository ppa:chris-lea/node.js</code></li>
  <li><code class="highlighter-rouge">sudo apt-get -y update</code></li>
  <li><code class="highlighter-rouge">sudo apt-get -y install nodejs</code></li>
</ol>

<h3 id="mongodb">MongoDB</h3>

<ol>
  <li><code class="highlighter-rouge">sudo apt-get -y install mongodb</code></li>
</ol>

<h3 id="dadi-track">DADI Track</h3>

<p>Install GCC to provide the latest build of the c++ bson extension (not required, but improves performance):</p>

<p><code class="highlighter-rouge">sudo apt-get install gcc make build-essential</code></p>

<p>Install Git and pull down the latest stable build of DADI Track:</p>

<ol>
  <li><code class="highlighter-rouge">sudo apt-get install git</code></li>
  <li><code class="highlighter-rouge">sudo git clone https://github.com/dadi/track.git</code></li>
  <li><code class="highlighter-rouge">cd track/</code></li>
</ol>

<p>Install DADI Track:</p>

<p><code class="highlighter-rouge">[sudo] cp config-sample.json config.json</code><br />
<code class="highlighter-rouge">[sudo] npm install</code></p>

<p>Perform tests:</p>

<p><code class="highlighter-rouge">[sudo] npm test</code></p>

<p>In order to get up and running you will also need to create a client document in the db. To automate this do:</p>

<p><code class="highlighter-rouge">node utils/create-client.js</code></p>

<p>Start the server:</p>

<p><code class="highlighter-rouge">[sudo] npm start</code></p>

<p>By default a dashboard will be run on port 80. You can disable it for production use within the config.</p>

<p><em>Note: the dashboard HTML is served out of the foleder <code class="highlighter-rouge">public/</code>: it can be served it using any webserver. For exmple, to run the UI locally but stream data from your production server, use the url http://localhost:8080/?ws_server=your-host.com&amp;ws_port=12345</em></p>

<h3 id="forever">Forever</h3>

<p>To run the API server in the background, install <a href="https://github.com/nodejitsu/forever">Forever</a> and <a href="https://github.com/zapty/forever-service">Forever-service</a>:</p>

<p><code class="highlighter-rouge">[sudo] npm install forever -g</code></p>

<p><code class="highlighter-rouge">[sudo] npm install -g forever-service</code></p>

<p>Install as a service and ensure it loads on boot:</p>

<p><code class="highlighter-rouge">[sudo] forever-service install -s main.js -e NODE_ENV=production track --start</code></p>

<p><em>Note the environment variable - <code class="highlighter-rouge">NODE_ENV=production</code> - must be set to target the required config version.</em></p>

<p>You can then interact with the service using the following command:</p>

<ul>
  <li>Start: <code class="highlighter-rouge">[sudo] start track</code></li>
  <li>Stop: <code class="highlighter-rouge">[sudo] stop track</code></li>
  <li>Status: <code class="highlighter-rouge">[sudo] status track</code></li>
  <li>Restart <code class="highlighter-rouge">[sudo] restart track</code></li>
</ul>
